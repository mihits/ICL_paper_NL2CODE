02/10/2024 11:48:09 - INFO - __main__ - Namespace(do_tensorize=True, tensorize_dir='tensorized', n_gpu=1, n_process=10, n_prefix_tokens=10, use_demonstrations=False, log_dir='logs', prefix_embed_file=None, dataset=None, task='code_dataset', split='train', data_dir='data/', k=16384, test_k=4, seed=100, train_seed=1, lr=0.01, warmup_steps=0, batch_size=4, num_training_steps=10000, weight_decay=0.0, no_masking=False, use_random_english_words=False, out_dir='checkpoints/gpt2/code_dataset-train/prefix={10}-{direct}-lr={1e-2}-initByVocab', method='direct', gpt2='gpt2', optimization='adamw', fp16=False, local_rank=-1, do_sanity_check=False, save_period=1000, log_period=250)
02/10/2024 11:48:09 - INFO - __main__ - batch_size=4	max_length=1024	max_length_per_example=1024
02/10/2024 11:48:09 - INFO - __main__ - [Train] humaneval	164
02/10/2024 11:48:09 - INFO - __main__ - [Train] mbbp	120
02/10/2024 11:48:09 - INFO - __main__ - direct on None (2 train)
prefix token ids:  {'humaneval': [50257, 50258, 50259, 50260, 50261, 50262, 50263, 50264, 50265, 50266], 'mbbp': [50267, 50268, 50269, 50270, 50271, 50272, 50273, 50274, 50275, 50276]}

Started Tensorization

02/10/2024 11:48:10 - INFO - __main__ - tensorized/code_dataset_direct_k=284_seed=100_length=10-1024-rank=%d.pkl
02/10/2024 11:48:10 - INFO - __main__ - tensorize file already exists...

Finished Tensorization

02/10/2024 11:48:10 - INFO - __main__ - tensorized/code_dataset_direct_k=284_seed=100_length=10-1024-rank=%d.pkl

Loaded Tensorized Data

2024-02-10 11:48:10.648457: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-02-10 11:48:10.648499: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-02-10 11:48:10.649796: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-02-10 11:48:11.841554: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
02/10/2024 11:48:12 - INFO - numexpr.utils - NumExpr defaulting to 2 threads.
02/10/2024 11:48:12 - INFO - __main__ - Checking the first example...
Input:
<humaneval-0><humaneval-1><humaneval-2><humaneval-3><humaneval-4><humaneval-5><humaneval-6><humaneval-7><humaneval-8><humaneval-9>Write a Python function `encode(message)` to solve the following problem:
Write a function that takes a message, and encodes in such a
way that it swaps case of all letters, replaces all vowels in
the message with the letter that appears 2 places ahead of that
vowel in the english alphabet.
Assume only letters.
Examples:
>>> encode('test')
'TGST'
>>> encode('This is a message')
'tHKS KS C MGSSCGG'
Output:
    vowels = "aeiouAEIOU"
    vowels_replace = dict([(i, chr(ord(i) + 2)) for i in vowels])
    message = message.swapcase()
    return ''.join([vowels_replace[i] if i in vowels else i for i in message])

02/10/2024 11:48:12 - INFO - __main__ - checkpoints/gpt2/code_dataset-train/prefix={10}-{direct}-lr={1e-2}-initByVocab
02/10/2024 11:48:12 - INFO - __main__ - Setting up for local_rank=-1, world_size=1
original vocab size:  50257
fine tune parameters:  [{'params': Parameter containing:
tensor([[-0.1101, -0.0393,  0.0331,  ..., -0.1364,  0.0151,  0.0453],
        [ 0.0403, -0.0486,  0.0462,  ...,  0.0861,  0.0025,  0.0432],
        [-0.1275,  0.0479,  0.1841,  ...,  0.0899, -0.1297, -0.0879],
        ...,
        [-0.0762, -0.0821,  0.1313,  ..., -0.0374,  0.2339, -0.0797],
        [-0.0913, -0.0297,  0.1686,  ..., -0.1519,  0.1601,  0.0403],
        [-0.1132, -0.0435,  0.0922,  ..., -0.0442,  0.2205, -0.0069]],
       device='cuda:0', requires_grad=True), 'weight_decay': 0.0}]
/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
02/10/2024 11:48:16 - INFO - __main__ - torch.Size([284, 1024])
02/10/2024 11:48:16 - INFO - __main__ - Training 1 parameters on 284 examples for 10000 steps using 1 GPUs
epoch:  0
  0% 0/57 [00:00<?, ?it/s]02/10/2024 11:48:17 - INFO - __main__ - local rank -1	global step 1	train loss 3.62

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:00<00:05,  2.49it/s]
 13% 2/15 [00:00<00:05,  2.49it/s]
 20% 3/15 [00:01<00:04,  2.47it/s]
 27% 4/15 [00:01<00:04,  2.47it/s]
 33% 5/15 [00:02<00:04,  2.46it/s]
 40% 6/15 [00:02<00:03,  2.46it/s]
 47% 7/15 [00:02<00:03,  2.46it/s]
 53% 8/15 [00:03<00:02,  2.46it/s]
 60% 9/15 [00:03<00:02,  2.46it/s]
 67% 10/15 [00:04<00:02,  2.46it/s]
 73% 11/15 [00:04<00:01,  2.46it/s]
 80% 12/15 [00:04<00:01,  2.46it/s]
 87% 13/15 [00:05<00:00,  2.45it/s]
 93% 14/15 [00:05<00:00,  2.45it/s]
100% 15/15 [00:05<00:00,  2.59it/s]
02/10/2024 11:48:23 - INFO - __main__ - local rank -1	val loss 2.76
100% 57/57 [01:06<00:00,  1.16s/it]
epoch:  1
100% 57/57 [01:01<00:00,  1.08s/it]
epoch:  2
100% 57/57 [01:02<00:00,  1.09s/it]
epoch:  3
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  4
 37% 21/57 [00:23<00:39,  1.11s/it]02/10/2024 11:52:53 - INFO - __main__ - local rank -1	global step 250	train loss 2.37

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.07s/it]
 13% 2/15 [00:01<00:09,  1.43it/s]
 20% 3/15 [00:01<00:06,  1.73it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.03it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:05<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 11:52:59 - INFO - __main__ - local rank -1	val loss 1.84
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  5
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  6
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  7
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  8
 75% 43/57 [00:47<00:15,  1.11s/it]02/10/2024 11:57:35 - INFO - __main__ - local rank -1	global step 500	train loss 2.20

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.06s/it]
 13% 2/15 [00:01<00:09,  1.43it/s]
 20% 3/15 [00:01<00:06,  1.73it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.03it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 11:57:42 - INFO - __main__ - local rank -1	val loss 1.76
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  9
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  10
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  11
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  12
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  13
 14% 8/57 [00:08<00:53,  1.10s/it]02/10/2024 12:02:17 - INFO - __main__ - local rank -1	global step 750	train loss 2.11

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.07s/it]
 13% 2/15 [00:01<00:09,  1.43it/s]
 20% 3/15 [00:01<00:06,  1.73it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.03it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:05<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:02:24 - INFO - __main__ - local rank -1	val loss 1.72
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  14
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  15
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  16
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  17
 53% 30/57 [00:33<00:29,  1.11s/it]02/10/2024 12:06:59 - INFO - __main__ - local rank -1	global step 1000	train loss 2.06

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.06s/it]
 13% 2/15 [00:01<00:09,  1.43it/s]
 20% 3/15 [00:01<00:06,  1.73it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.25it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:07:06 - INFO - __main__ - local rank -1	val loss 1.73
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  18
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  19
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  20
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  21
 91% 52/57 [00:57<00:05,  1.11s/it]02/10/2024 12:11:42 - INFO - __main__ - local rank -1	global step 1250	train loss 2.02

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 12:11:49 - INFO - __main__ - local rank -1	val loss 1.68
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  22
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  23
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  24
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  25
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  26
 30% 17/57 [00:18<00:44,  1.11s/it]02/10/2024 12:16:24 - INFO - __main__ - local rank -1	global step 1500	train loss 1.99

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.06s/it]
 13% 2/15 [00:01<00:09,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:16:31 - INFO - __main__ - local rank -1	val loss 1.69
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  27
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  28
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  29
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  30
 68% 39/57 [00:43<00:19,  1.11s/it]02/10/2024 12:21:06 - INFO - __main__ - local rank -1	global step 1750	train loss 1.97

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.06s/it]
 13% 2/15 [00:01<00:09,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:21:13 - INFO - __main__ - local rank -1	val loss 1.65
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  31
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  32
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  33
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  34
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  35
  7% 4/57 [00:04<00:57,  1.09s/it]02/10/2024 12:25:48 - INFO - __main__ - local rank -1	global step 2000	train loss 1.96

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.06s/it]
 13% 2/15 [00:01<00:09,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.73it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:25:55 - INFO - __main__ - local rank -1	val loss 1.65
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  36
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  37
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  38
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  39
 46% 26/57 [00:28<00:34,  1.11s/it]02/10/2024 12:30:31 - INFO - __main__ - local rank -1	global step 2250	train loss 1.94

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:30:38 - INFO - __main__ - local rank -1	val loss 1.68
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  40
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  41
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  42
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  43
 84% 48/57 [00:53<00:09,  1.11s/it]02/10/2024 12:35:13 - INFO - __main__ - local rank -1	global step 2500	train loss 1.93

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 12:35:20 - INFO - __main__ - local rank -1	val loss 1.69
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  44
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  45
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  46
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  47
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  48
 23% 13/57 [00:14<00:48,  1.11s/it]02/10/2024 12:39:56 - INFO - __main__ - local rank -1	global step 2750	train loss 1.92

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.91it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.16it/s]
 53% 8/15 [00:04<00:03,  2.20it/s]
 60% 9/15 [00:04<00:02,  2.22it/s]
 67% 10/15 [00:04<00:02,  2.24it/s]
 73% 11/15 [00:05<00:01,  2.25it/s]
 80% 12/15 [00:05<00:01,  2.26it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.27it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:40:02 - INFO - __main__ - local rank -1	val loss 1.62
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  49
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  50
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  51
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  52
 61% 35/57 [00:38<00:24,  1.11s/it]02/10/2024 12:44:38 - INFO - __main__ - local rank -1	global step 3000	train loss 1.91

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 12:44:45 - INFO - __main__ - local rank -1	val loss 1.67
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  53
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  54
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  55
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  56
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  57
  0% 0/57 [00:00<?, ?it/s]02/10/2024 12:49:21 - INFO - __main__ - local rank -1	global step 3250	train loss 1.90

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 12:49:28 - INFO - __main__ - local rank -1	val loss 1.64
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  58
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  59
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  60
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  61
 39% 22/57 [00:24<00:38,  1.11s/it]02/10/2024 12:54:03 - INFO - __main__ - local rank -1	global step 3500	train loss 1.89

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.02s/it]
 13% 2/15 [00:01<00:08,  1.47it/s]
 20% 3/15 [00:01<00:06,  1.76it/s]
 27% 4/15 [00:02<00:05,  1.94it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.13it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.22it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.21it/s]
02/10/2024 12:54:10 - INFO - __main__ - local rank -1	val loss 1.66
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  62
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  63
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  64
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  65
 77% 44/57 [00:48<00:14,  1.11s/it]02/10/2024 12:58:46 - INFO - __main__ - local rank -1	global step 3750	train loss 1.88

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:09,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 12:58:52 - INFO - __main__ - local rank -1	val loss 1.67
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  66
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  67
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  68
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  69
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  70
 16% 9/57 [00:09<00:53,  1.11s/it]02/10/2024 13:03:28 - INFO - __main__ - local rank -1	global step 4000	train loss 1.88

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.03s/it]
 13% 2/15 [00:01<00:08,  1.46it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.13it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.22it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:03:34 - INFO - __main__ - local rank -1	val loss 1.62
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  71
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  72
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  73
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  74
 54% 31/57 [00:34<00:28,  1.11s/it]02/10/2024 13:08:11 - INFO - __main__ - local rank -1	global step 4250	train loss 1.87

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 13:08:17 - INFO - __main__ - local rank -1	val loss 1.59
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  75
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  76
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  77
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  78
 93% 53/57 [00:58<00:04,  1.11s/it]02/10/2024 13:12:53 - INFO - __main__ - local rank -1	global step 4500	train loss 1.86

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.05s/it]
 13% 2/15 [00:01<00:09,  1.44it/s]
 20% 3/15 [00:01<00:06,  1.74it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.11it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 13:13:00 - INFO - __main__ - local rank -1	val loss 1.63
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  79
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  80
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  81
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  82
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  83
 32% 18/57 [00:19<00:43,  1.11s/it]02/10/2024 13:17:35 - INFO - __main__ - local rank -1	global step 4750	train loss 1.86

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:17:42 - INFO - __main__ - local rank -1	val loss 1.61
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  84
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  85
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  86
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  87
 70% 40/57 [00:44<00:18,  1.11s/it]02/10/2024 13:22:17 - INFO - __main__ - local rank -1	global step 5000	train loss 1.85

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.22it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:22:24 - INFO - __main__ - local rank -1	val loss 1.61
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  88
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  89
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  90
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  91
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  92
  9% 5/57 [00:05<00:57,  1.10s/it]02/10/2024 13:27:00 - INFO - __main__ - local rank -1	global step 5250	train loss 1.85

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.02s/it]
 13% 2/15 [00:01<00:08,  1.47it/s]
 20% 3/15 [00:01<00:06,  1.76it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.25it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.27it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:27:07 - INFO - __main__ - local rank -1	val loss 1.61
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  93
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  94
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  95
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  96
 47% 27/57 [00:29<00:33,  1.11s/it]02/10/2024 13:31:43 - INFO - __main__ - local rank -1	global step 5500	train loss 1.85

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.02s/it]
 13% 2/15 [00:01<00:08,  1.47it/s]
 20% 3/15 [00:01<00:06,  1.76it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.13it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.24it/s]
 73% 11/15 [00:05<00:01,  2.25it/s]
 80% 12/15 [00:05<00:01,  2.26it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.27it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:31:49 - INFO - __main__ - local rank -1	val loss 1.66
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  97
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  98
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  99
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  100
 86% 49/57 [00:54<00:08,  1.11s/it]02/10/2024 13:36:25 - INFO - __main__ - local rank -1	global step 5750	train loss 1.84

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.46it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.04it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.19it/s]
02/10/2024 13:36:32 - INFO - __main__ - local rank -1	val loss 1.59
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  101
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  102
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  103
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  104
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  105
 25% 14/57 [00:15<00:47,  1.10s/it]02/10/2024 13:41:07 - INFO - __main__ - local rank -1	global step 6000	train loss 1.84

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.03s/it]
 13% 2/15 [00:01<00:08,  1.46it/s]
 20% 3/15 [00:01<00:06,  1.76it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.13it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:41:14 - INFO - __main__ - local rank -1	val loss 1.61
100% 57/57 [01:09<00:00,  1.22s/it]
epoch:  106
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  107
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  108
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  109
 63% 36/57 [00:39<00:23,  1.11s/it]02/10/2024 13:45:50 - INFO - __main__ - local rank -1	global step 6250	train loss 1.83

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.93it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.13it/s]
 47% 7/15 [00:03<00:03,  2.18it/s]
 53% 8/15 [00:04<00:03,  2.22it/s]
 60% 9/15 [00:04<00:02,  2.24it/s]
 67% 10/15 [00:04<00:02,  2.26it/s]
 73% 11/15 [00:05<00:01,  2.27it/s]
 80% 12/15 [00:05<00:01,  2.28it/s]
 87% 13/15 [00:06<00:00,  2.28it/s]
 93% 14/15 [00:06<00:00,  2.29it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:45:57 - INFO - __main__ - local rank -1	val loss 1.60
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  110
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  111
100% 57/57 [01:02<00:00,  1.11s/it]
epoch:  112
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  113
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  114
  2% 1/57 [00:00<00:52,  1.06it/s]02/10/2024 13:50:32 - INFO - __main__ - local rank -1	global step 6500	train loss 1.83

  0% 0/15 [00:00<?, ?it/s]
  7% 1/15 [00:01<00:14,  1.04s/it]
 13% 2/15 [00:01<00:08,  1.45it/s]
 20% 3/15 [00:01<00:06,  1.75it/s]
 27% 4/15 [00:02<00:05,  1.92it/s]
 33% 5/15 [00:02<00:04,  2.05it/s]
 40% 6/15 [00:03<00:04,  2.12it/s]
 47% 7/15 [00:03<00:03,  2.17it/s]
 53% 8/15 [00:04<00:03,  2.21it/s]
 60% 9/15 [00:04<00:02,  2.23it/s]
 67% 10/15 [00:04<00:02,  2.25it/s]
 73% 11/15 [00:05<00:01,  2.26it/s]
 80% 12/15 [00:05<00:01,  2.27it/s]
 87% 13/15 [00:06<00:00,  2.27it/s]
 93% 14/15 [00:06<00:00,  2.28it/s]
100% 15/15 [00:06<00:00,  2.20it/s]
02/10/2024 13:50:39 - INFO - __main__ - local rank -1	val loss 1.61
100% 57/57 [01:09<00:00,  1.21s/it]
epoch:  115
100% 57/57 [01:02<00:00,  1.10s/it]
epoch:  116
100% 57/57 [01:03<00:00,  1.11s/it]
epoch:  117
 58% 33/57 [00:36<00:26,  1.11s/it]